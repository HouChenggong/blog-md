# redis 使用场景

- 缓存
- 分布式缓存
- 验证码过期时间，通过设置key的过期时间
- 积分排行榜
- 限流，限制IP次数，可以整合AOP+注解的方式
- 消息队列
- 分布式锁
- 热门列表
- 限制登录次数
- 唯一登录。在系统登录成功后记录这个账号信息，如果此账号在其他地方又登录，就清除某个token信息



### redis数据结构

string hash list set zset(有序)

HyperLogLog Pub/Sub BloomFilter



### 布隆过滤器

比hashMap更节省空间

理论上存一百万个数，一个int是4字节32位，需要4*8*1000000=3200万位。如果使用HashMap去存，按HashMap50%的存储效率，需要6400万位。可以看出BloomFilter的存储空间很小，只有HashMap的1/10左右

而Bloom Filter只需要哈希表 1/8到 1/4 的大小就能解决同样的问题。

### redis 缓存击穿、穿透

缓存穿透：在高并发下，查询一个不存在的值时，缓存不会被命中，导致大量请求直接落到数据库上，如活动系统里面查询一个不存在的活动。



缓存击穿，是指一个key非常热点，在不停的扛着大并发，大并发集中对这一个点进行访问，当这个key在失效的瞬间，持续的大并发就穿破缓存，直接请求数据库，就像在一个屏障上凿开了一个洞。

比如说：黑客模拟攻击或者redis值过期

### 缓存雪崩

如果大量的key过期时间设置的过于集中，到过期的那个时间点，redis可能会出现短暂的卡顿现象。严重的话会出现缓存雪崩，我们一般需要在时间上加一个随机值，使得过期时间分散一些。

#### 限流、布隆过滤器、缓存时间分散

